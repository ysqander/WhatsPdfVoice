Trying alternate media path: /tmp/whatspdf/media/00000002-AUDIO-2025-05-04-10-29-03.opus
Uploading voice message to R2: /tmp/whatspdf/media/00000002-AUDIO-2025-05-04-10-29-03.opus
Uploaded file to R2: chats/1/voice/00000002_audio_2025_05_04_10_29_03_4cbc4618-0e13-4ddf-b6ab-27e766c9a108.opus
Uploaded media file to R2: chats/1/voice/00000002_audio_2025_05_04_10_29_03_4cbc4618-0e13-4ddf-b6ab-27e766c9a108.opus
Setting message 11 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/0f45d536-80a3-46f2-83b4-c6588a66c3cc
Uploaded voice message to R2, key: chats/1/voice/00000002_audio_2025_05_04_10_29_03_4cbc4618-0e13-4ddf-b6ab-27e766c9a108.opus
Trying alternate media path: /tmp/whatspdf/media/00000004-AUDIO-2025-05-04-10-29-35.opus
Uploading voice message to R2: /tmp/whatspdf/media/00000004-AUDIO-2025-05-04-10-29-35.opus
Uploaded file to R2: chats/1/voice/00000004_audio_2025_05_04_10_29_35_1278181b-0f1a-44ab-8bba-1f0be12fbc0c.opus
Uploaded media file to R2: chats/1/voice/00000004_audio_2025_05_04_10_29_35_1278181b-0f1a-44ab-8bba-1f0be12fbc0c.opus
Setting message 13 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/9e20d1c5-9a1c-43ae-843e-08b39bc43c55
Uploaded voice message to R2, key: chats/1/voice/00000004_audio_2025_05_04_10_29_35_1278181b-0f1a-44ab-8bba-1f0be12fbc0c.opus
Trying alternate media path: /tmp/whatspdf/media/00000005-AUDIO-2025-05-04-10-29-50.opus
Uploading voice message to R2: /tmp/whatspdf/media/00000005-AUDIO-2025-05-04-10-29-50.opus
Uploaded file to R2: chats/1/voice/00000005_audio_2025_05_04_10_29_50_f18be076-2ec8-40d6-86ca-99be0503e8bf.opus
Uploaded media file to R2: chats/1/voice/00000005_audio_2025_05_04_10_29_50_f18be076-2ec8-40d6-86ca-99be0503e8bf.opus
Setting message 14 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/4bdf4223-fc03-4996-9f5e-a199c2402980
Uploaded voice message to R2, key: chats/1/voice/00000005_audio_2025_05_04_10_29_50_f18be076-2ec8-40d6-86ca-99be0503e8bf.opus
Trying alternate media path: /tmp/whatspdf/media/00000006-AUDIO-2025-05-04-10-30-08.opus
Uploading voice message to R2: /tmp/whatspdf/media/00000006-AUDIO-2025-05-04-10-30-08.opus
Uploaded file to R2: chats/1/voice/00000006_audio_2025_05_04_10_30_08_2ec16908-1255-45c9-804c-550e36798dba.opus
Uploaded media file to R2: chats/1/voice/00000006_audio_2025_05_04_10_30_08_2ec16908-1255-45c9-804c-550e36798dba.opus
Setting message 15 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/63286d03-f176-4a8a-9112-29ae512c5916
Uploaded voice message to R2, key: chats/1/voice/00000006_audio_2025_05_04_10_30_08_2ec16908-1255-45c9-804c-550e36798dba.opus
Trying alternate media path: /tmp/whatspdf/media/00000008-AUDIO-2025-05-04-10-28-20.opus
Uploading voice message to R2: /tmp/whatspdf/media/00000008-AUDIO-2025-05-04-10-28-20.opus
Uploaded file to R2: chats/1/voice/00000008_audio_2025_05_04_10_28_20_9fc3e687-07ef-49b8-b4b4-32adc0583b3b.opus
Uploaded media file to R2: chats/1/voice/00000008_audio_2025_05_04_10_28_20_9fc3e687-07ef-49b8-b4b4-32adc0583b3b.opus
Setting message 17 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/3ff55d64-f5df-4c7f-aade-1cf6ab2f1dde
Uploaded voice message to R2, key: chats/1/voice/00000008_audio_2025_05_04_10_28_20_9fc3e687-07ef-49b8-b4b4-32adc0583b3b.opus
Processing 2 other media messages
Trying alternate media path: /tmp/whatspdf/media/00000010-PHOTO-2025-05-04-10-53-14.jpg
Uploading image to R2: /tmp/whatspdf/media/00000010-PHOTO-2025-05-04-10-53-14.jpg
Uploaded file to R2: chats/1/image/00000010_photo_2025_05_04_10_53_14_f4e93a98-682a-41d4-a608-9e32d46b3849.jpg
Uploaded media file to R2: chats/1/image/00000010_photo_2025_05_04_10_53_14_f4e93a98-682a-41d4-a608-9e32d46b3849.jpg
Setting message 19 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/dc08bb31-6134-4d7e-993b-183a0f064bed
Uploaded image to R2, key: chats/1/image/00000010_photo_2025_05_04_10_53_14_f4e93a98-682a-41d4-a608-9e32d46b3849.jpg
Trying alternate media path: /tmp/whatspdf/media/00000013-a89e0bcf_2d07_4959_bfbb_deb4d0b97756_1507e127-f564-48fd-8187-6cb13bdb0c4c.pdf
Uploading attachment to R2: /tmp/whatspdf/media/00000013-a89e0bcf_2d07_4959_bfbb_deb4d0b97756_1507e127-f564-48fd-8187-6cb13bdb0c4c.pdf
Uploaded file to R2: chats/1/attachment/00000013_a89e0bcf_2d07_4959_bfbb_deb4d0b97756_1507e127_f564_48fd_8187_6cb13bdb0c4c_2c9dfdd1-cc67-4386-b98d-44866056d1a6.pdf
Uploaded media file to R2: chats/1/attachment/00000013_a89e0bcf_2d07_4959_bfbb_deb4d0b97756_1507e127_f564_48fd_8187_6cb13bdb0c4c_2c9dfdd1-cc67-4386-b98d-44866056d1a6.pdf
Setting message 22 media URL to proxy: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/f70523e3-75bd-424a-9992-7f2958f507fd
Uploaded attachment to R2, key: chats/1/attachment/00000013_a89e0bcf_2d07_4959_bfbb_deb4d0b97756_1507e127_f564_48fd_8187_6cb13bdb0c4c_2c9dfdd1-cc67-4386-b98d-44866056d1a6.pdf
Starting PDF generation for chat export: 1
Starting PDF generation with pdf-lib...
ChatExport ID is missing, cannot fetch media files for proxy links.
PDF: ChatExport ID missing, skipping media file fetch. Proxy links will use original URLs.
PDF (Chat N/A): Using original/fallback URL for message 3 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/7817b2cf-35be-4dee-849d-042af612c58f
PDF (Chat N/A): Using original/fallback URL for message 7 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/ac69c846-4054-4f43-90f7-4dcacd648947
PDF (Chat N/A): Using original/fallback URL for message 9 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/619afcf2-b6b7-4743-8efe-191cdea56881
PDF (Chat N/A): Using original/fallback URL for message 17 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/3ff55d64-f5df-4c7f-aade-1cf6ab2f1dde
PDF (Chat N/A): Using original/fallback URL for message 11 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/0f45d536-80a3-46f2-83b4-c6588a66c3cc
PDF (Chat N/A): Using original/fallback URL for message 13 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/9e20d1c5-9a1c-43ae-843e-08b39bc43c55
PDF (Chat N/A): Using original/fallback URL for message 14 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/4bdf4223-fc03-4996-9f5e-a199c2402980
PDF (Chat N/A): Using original/fallback URL for message 15 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/63286d03-f176-4a8a-9112-29ae512c5916
PDF (Chat N/A): Using original/fallback URL for image message 19 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/dc08bb31-6134-4d7e-993b-183a0f064bed
PDF (Chat N/A): Using original/fallback URL for attachment message 22 -> https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/f70523e3-75bd-424a-9992-7f2958f507fd
Saving PDF document...
PDF file written successfully to: /tmp/whatspdf/pdfs/49e594a4-ad93-48f7-b596-294a6c819fab.pdf
PDF details: { pdfId: '49e594a4-ad93-48f7-b596-294a6c819fab', size: 6042 }
PDF generation completed: /tmp/whatspdf/pdfs/49e594a4-ad93-48f7-b596-294a6c819fab.pdf
Uploaded file to R2: chats/1/pdf/49e594a4_ad93_48f7_b596_294a6c819fab_56a8cb3c-e4a3-4b28-ad3b-ea251d1c0ad4.pdf
Uploaded media file to R2: chats/1/pdf/49e594a4_ad93_48f7_b596_294a6c819fab_56a8cb3c-e4a3-4b28-ad3b-ea251d1c0ad4.pdf
Uploaded PDF to R2: chats/1/pdf/49e594a4_ad93_48f7_b596_294a6c819fab_56a8cb3c-e4a3-4b28-ad3b-ea251d1c0ad4.pdf
Generated proxy URL for PDF: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/8dfe04de-ec90-475c-9f0b-ab0929f8022b
Generated PDF URL: https://eb380b0b-741a-48b9-8f0b-a23721457a3d-00-8jgcrykxyo77.worf.replit.dev/api/media/proxy/8dfe04de-ec90-475c-9f0b-ab0929f8022b
PDF URL saved to storage for chat export: 1
11:00:19 AM [express] GET /api/whatsapp/process-status 200 in 9564ms
Media proxy request received for ID: 8dfe04de-ec90-475c-9f0b-ab0929f8022b
Found media proxy record, R2 key: chats/1/pdf/49e594a4_ad93_48f7_b596_294a6c819fab_56a8cb3c-e4a3-4b28-ad3b-ea251d1c0ad4.pdf
Redirecting to R2 URL
11:00:20 AM [express] GET /api/media/proxy/8dfe04de-ec90-475c-9f0b-ab0929f8022b 302 in 52ms