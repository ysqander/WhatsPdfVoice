 path: '/tmp/whatspdf-uploads/file-1746286698710-79210429-deb5-42ac-a6dc-b320ac878db2.zip'
}
Waiting for SSE connection for clientId: 05882880-fef7-45b2-b869-0eb2f8f782d2
3:38:18 PM [express] POST /api/whatsapp/process 200 in 262ms :: {"clientId":"05882880-fef7-45b2-b869…
Starting background processing for clientId: 05882880-fef7-45b2-b869-0eb2f8f782d2
Starting parse for file: /tmp/whatspdf-uploads/file-1746286698710-79210429-deb5-42ac-a6dc-b320ac878db2.zip
Parsed chat export: {
  messageCount: 9,
  participantCount: 2,
  firstMessageSample: {
    timestamp: '2025-05-01T18:27:34',
    sender: 'Iris Adamov',
    content: 'Hi Alex, there’s mold coming back in the corner of the bedroom again. Can you please arrange for someone to look at it?',
    type: 'text',
    mediaUrl: undefined,
    duration: undefined
  },
  options: {
    includeVoiceMessages: true,
    includeTimestamps: true,
    highlightSenders: true,
    includeImages: false,
    includeAttachments: false
  }
}
Parse completed successfully
R2 connection successful
R2 connection successful, proceeding with media uploads
Found 3 media messages to upload to R2
Starting PDF generation for chat export: 2
Grouped messages by date: {
  totalDates: 1,
  messagesByDateSample: [ { date: '01 May 2025', messageCount: 9 } ]
}
Error generating signed URL: Error: Signature version 4 presigned URLs must have an expiration date less than one week in the future
    at asSdkError (/home/runner/workspace/node_modules/@smithy/middleware-retry/dist-cjs/index.js:102:12)
    at /home/runner/workspace/node_modules/@smithy/middleware-retry/dist-cjs/index.js:327:21
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22
    at async getSignedUrl (/home/runner/workspace/node_modules/@aws-sdk/s3-request-presigner/dist-cjs/index.js:176:22)
    at async getSignedR2Url (/home/runner/workspace/server/lib/r2Storage.ts:127:23)
    at async generatePdfWithPdfLib (/home/runner/workspace/server/lib/pdf.ts:256:32)
    at async generatePdf (/home/runner/workspace/server/lib/pdf.ts:21:23)
    at async <anonymous> (/home/runner/workspace/server/controllers/uploadController.ts:209:29) {
  '$metadata': { attempts: 1, totalRetryDelay: 0 }
}
Error processing file: Error: Signature version 4 presigned URLs must have an expiration date less than one week in the future
    at asSdkError (/home/runner/workspace/node_modules/@smithy/middleware-retry/dist-cjs/index.js:102:12)
    at /home/runner/workspace/node_modules/@smithy/middleware-retry/dist-cjs/index.js:327:21
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:110:22
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-sdk-s3/dist-cjs/index.js:137:14
    at async /home/runner/workspace/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22
    at async getSignedUrl (/home/runner/workspace/node_modules/@aws-sdk/s3-request-presigner/dist-cjs/index.js:176:22)
    at async getSignedR2Url (/home/runner/workspace/server/lib/r2Storage.ts:127:23)
    at async generatePdfWithPdfLib (/home/runner/workspace/server/lib/pdf.ts:256:32)
    at async generatePdf (/home/runner/workspace/server/lib/pdf.ts:21:23)
    at async <anonymous> (/home/runner/workspace/server/controllers/uploadController.ts:209:29) {
  '$metadata': { attempts: 1, totalRetryDelay: 0 }
}
3:38:19 PM [express] GET /api/whatsapp/process-status 200 in 218ms