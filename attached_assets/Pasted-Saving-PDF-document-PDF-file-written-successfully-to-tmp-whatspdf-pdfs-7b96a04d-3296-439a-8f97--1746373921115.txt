Saving PDF document...
PDF file written successfully to: /tmp/whatspdf/pdfs/7b96a04d-3296-439a-8f97-69f773ae3820.pdf
PDF details: { pdfId: '7b96a04d-3296-439a-8f97-69f773ae3820', size: 4973 }
PDF generation completed for payment: /tmp/whatspdf/pdfs/7b96a04d-3296-439a-8f97-69f773ae3820.pdf
3:50:33 PM [express] GET /api/whatsapp/process-status 200 in 3990ms
3:50:39 PM [express] POST /api/create-payment-intent 200 in 572ms :: {"success":true,"clientSecret":…
Webhook received. Headers: {
  'content-type': 'application/json; charset=utf-8',
  'stripe-signature': 'Present'
}
Request body type: object false
⚠️ Webhook signature verification failed: StripeSignatureVerificationError: Webhook payload must be provided as a string or a Buffer (https://nodejs.org/api/buffer.html) instance representing the _raw_ request body.Payload was provided as a parsed JavaScript object instead. 
Signature verification is impossible without access to the original signed material. 

Learn more about webhook signing and explore webhook integration examples for various frameworks at https://docs.stripe.com/webhooks/signature

    at validateComputedSignature (file:///home/runner/workspace/node_modules/stripe/esm/Webhooks.js:135:23)
    at Object.verifyHeader (file:///home/runner/workspace/node_modules/stripe/esm/Webhooks.js:67:13)
    at Object.constructEvent (file:///home/runner/workspace/node_modules/stripe/esm/Webhooks.js:12:32)
    at <anonymous> (/home/runner/workspace/server/routes.ts:256:33)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at rawParser (/home/runner/workspace/node_modules/body-parser/lib/types/raw.js:58:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:646:15
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:265:14)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at <anonymous> (/home/runner/workspace/server/index.ts:37:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at urlencodedParser (/home/runner/workspace/node_modules/body-parser/lib/types/urlencoded.js:85:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at /home/runner/workspace/node_modules/body-parser/lib/read.js:137:5
    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
    at invokeCallback (/home/runner/workspace/node_modules/raw-body/index.js:238:16)
    at done (/home/runner/workspace/node_modules/raw-body/index.js:227:7)
    at IncomingMessage.onEnd (/home/runner/workspace/node_modules/raw-body/index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  type: 'StripeSignatureVerificationError',
  raw: {
    message: 'Webhook payload must be provided as a string or a Buffer (https://nodejs.org/api/buffer.html) instance representing the _raw_ request body.Payload was provided as a parsed JavaScript object instead. \n' +
      'Signature verification is impossible without access to the original signed material. \n' +
      '\n' +
      'Learn more about webhook signing and explore webhook integration examples for various frameworks at https://docs.stripe.com/webhooks/signature\n'
  },
  rawType: undefined,
  code: undefined,
  doc_url: undefined,
  param: undefined,
  detail: undefined,
  headers: undefined,
  requestId: undefined,
  statusCode: undefined,
  userMessage: undefined,
  charge: undefined,
  decline_code: undefined,
  payment_intent: undefined,
  payment_method: undefined,
  payment_method_type: undefined,
  setup_intent: undefined,
  source: undefined,
  header: 't=1746373867,v1=c04df7cf6b8437412d78058ec786e57421e6c6769f85253fbd5825f1a5441e76,v0=4291c6e852756740cb6f2e064dc2a9ab784730df66bdcad5972d7de3bffd9db3',
  payload: {
    id: 'evt_1RL4opGMYJBaxnOIgMhDDV71',
    object: 'event',
    api_version: '2025-04-30.basil',
    created: 1746373867,
    data: { object: [Object] },
    livemode: false,
    pending_webhooks: 1,
    request: { id: null, idempotency_key: null },
    type: 'checkout.session.completed'
  }
}
3:51:20 PM [express] GET /api/payment/746bcb9d-403a-43b8-89ae-47595b55d6ed 200 in 28ms :: {"bundleId…